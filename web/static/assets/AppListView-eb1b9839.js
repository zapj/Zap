import{d as A,L as G,u as J,O as W,ab as L,e as f,a as t,f as p,m as h,F as v,P as z,b as k,j as _,_ as H,am as oe,M as ne,c as ae,g as x,i as j,p as E,t as y,k as T,l as ie,aa as re,J as ce,r as R,o as Q,N as ue,w as r,h as F,ai as pe}from"./index-5f1d5677.js";import{E as de,a as me}from"./el-col-eefd0fcc.js";import{E as fe}from"./el-card-ac03ff2e.js";import{E as X}from"./el-button-36f688bf.js";/* empty css               */import{a as Y}from"./client-784b0ed6.js";import{E as _e}from"./el-drawer-31e80bcc.js";import"./el-overlay-9a8a4373.js";import{E as ve,a as ye}from"./el-form-item-fb5c76a3.js";import{b as be,a as ge}from"./el-radio-button-0ea722af.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{E as K}from"./index-90345743.js";import{g as we,f as ke}from"./vnode-98fc9e80.js";import{t as q}from"./index-f7883cef.js";import{i as Ce}from"./isNil-c75b1b34.js";import{b as M,d as Ee}from"./runtime-89a56c03.js";import{u as Se}from"./index-fce2b169.js";import{u as Ne}from"./use-form-common-props-4758c941.js";import{E as Z}from"./index-b91c3e99.js";import"./typescript-e92ae92a.js";import"./index-fcde9027.js";import"./use-global-config-71ca7aac.js";import"./use-form-item-7da9f99e.js";import"./constants-84857360.js";import"./index-110ef5f1.js";import"./index-c6108575.js";import"./error-78e43d3e.js";import"./focus-trap-c933673f.js";import"./event-8e91c63d.js";import"./castArray-0e666096.js";import"./_initCloneObject-1dcc91f6.js";const O=Symbol("elDescriptions");var B=A({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:G(O,{})}},render(){var I,d,o,b,c,e,S;const u=we(this.cell),s=(((I=this.cell)==null?void 0:I.dirs)||[]).map($=>{const{dir:U,arg:te,modifiers:le,value:se}=$;return[U,se,te,le]}),{border:m,direction:l}=this.descriptions,a=l==="vertical",N=((b=(o=(d=this.cell)==null?void 0:d.children)==null?void 0:o.label)==null?void 0:b.call(o))||u.label,g=(S=(e=(c=this.cell)==null?void 0:c.children)==null?void 0:e.default)==null?void 0:S.call(e),i=u.span,C=u.align?`is-${u.align}`:"",w=u.labelAlign?`is-${u.labelAlign}`:C,D=u.className,V=u.labelClassName,P={width:q(u.width),minWidth:q(u.minWidth)},n=J("descriptions");switch(this.type){case"label":return W(L(this.tag,{style:P,class:[n.e("cell"),n.e("label"),n.is("bordered-label",m),n.is("vertical-label",a),w,V],colSpan:a?i:1},N),s);case"content":return W(L(this.tag,{style:P,class:[n.e("cell"),n.e("content"),n.is("bordered-content",m),n.is("vertical-content",a),C,D],colSpan:a?i:i*2-1},g),s);default:return W(L("td",{style:P,class:[n.e("cell"),C],colSpan:i},[Ce(N)?void 0:L("span",{class:[n.e("label"),V]},N),L("span",{class:[n.e("content"),D]},g)]),s)}}});const ze=M({row:{type:Ee(Array),default:()=>[]}}),De={key:1},$e=A({name:"ElDescriptionsRow"}),Ie=A({...$e,props:ze,setup(I){const d=G(O,{});return(o,b)=>f(d).direction==="vertical"?(t(),p(v,{key:0},[h("tr",null,[(t(!0),p(v,null,z(o.row,(c,e)=>(t(),k(f(B),{key:`tr1-${e}`,cell:c,tag:"th",type:"label"},null,8,["cell"]))),128))]),h("tr",null,[(t(!0),p(v,null,z(o.row,(c,e)=>(t(),k(f(B),{key:`tr2-${e}`,cell:c,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(t(),p("tr",De,[(t(!0),p(v,null,z(o.row,(c,e)=>(t(),p(v,{key:`tr3-${e}`},[f(d).border?(t(),p(v,{key:0},[_(f(B),{cell:c,tag:"td",type:"label"},null,8,["cell"]),_(f(B),{cell:c,tag:"td",type:"content"},null,8,["cell"])],64)):(t(),k(f(B),{key:1,cell:c,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var xe=H(Ie,[["__file","descriptions-row.vue"]]);const Re=M({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Se,title:{type:String,default:""},extra:{type:String,default:""}}),Ae=A({name:"ElDescriptions"}),Ve=A({...Ae,props:Re,setup(I){const d=I,o=J("descriptions"),b=Ne(),c=oe();ne(O,d);const e=ae(()=>[o.b(),o.m(b.value)]),S=(s,m,l,a=!1)=>(s.props||(s.props={}),m>l&&(s.props.span=l),a&&(s.props.span=m),s),u=()=>{if(!c.default)return[];const s=ke(c.default()).filter(g=>{var i;return((i=g==null?void 0:g.type)==null?void 0:i.name)==="ElDescriptionsItem"}),m=[];let l=[],a=d.column,N=0;return s.forEach((g,i)=>{var C;const w=((C=g.props)==null?void 0:C.span)||1;if(i<s.length-1&&(N+=w>a?a:w),i===s.length-1){const D=d.column-N%d.column;l.push(S(g,D,a,!0)),m.push(l);return}w<a?(a-=w,l.push(g)):(l.push(S(g,w,a)),m.push(l),a=d.column,l=[])}),m};return(s,m)=>(t(),p("div",{class:x(f(e))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(t(),p("div",{key:0,class:x(f(o).e("header"))},[h("div",{class:x(f(o).e("title"))},[j(s.$slots,"title",{},()=>[E(y(s.title),1)])],2),h("div",{class:x(f(o).e("extra"))},[j(s.$slots,"extra",{},()=>[E(y(s.extra),1)])],2)],2)):T("v-if",!0),h("div",{class:x(f(o).e("body"))},[h("table",{class:x([f(o).e("table"),f(o).is("bordered",s.border)])},[h("tbody",null,[(t(!0),p(v,null,z(u(),(l,a)=>(t(),k(xe,{key:a,row:l},null,8,["row"]))),128))])],2)],2)],2))}});var Pe=H(Ve,[["__file","description.vue"]]);const Le=M({label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),ee=A({name:"ElDescriptionsItem",props:Le}),Be=ie(Pe,{DescriptionsItem:ee}),Fe=re(ee);const We={__name:"InstallConfirm",setup(I,{expose:d}){let o="50%";const b=ce({version:"",id:0}),c=R(),e=R({});Q(()=>{window.addEventListener("resize",S)}),ue(()=>{window.removeEventListener("resize",S)});const S=()=>{document.body.clientWidth<1200&&document.body.clientWidth>768?o="60%":document.body.clientWidth<768?o="100%":o="50%"};function u(m){Y({url:"/v1/app/appstore/install",method:"post",data:{id:e.value.app_id,action:m,version:b.version},dataType:"form"}).then(l=>{console.log(l),l.code==0?K({type:"success",message:l.msg}):K({type:"error",message:l.msg})})}return d({setAppInfo:function(m){e.value=m,b.id=e.value.id;for(let l=0;l<e.value.version.length;l++)if(e.value.already_installed_version.indexOf(e.value.version[l])!==-1){e.value.version[l];break}}}),(m,l)=>{const a=Fe,N=Z,g=Be,i=be,C=ge,w=ve,D=X,V=ye,P=_e;return t(),k(P,{title:"安装确认",size:f(o),"append-to-body":!0,direction:"rtl"},{header:r(()=>[h("span",null,"安装"+y(e.value.title),1)]),default:r(()=>[_(g,{title:"应用信息",column:1},{default:r(()=>[_(a,{label:"应用名称"},{default:r(()=>[E(y(e.value.title),1)]),_:1}),_(a,{label:"应用Name"},{default:r(()=>[E(y(e.value.name),1)]),_:1}),_(a,{label:"Tag"},{default:r(()=>[(t(!0),p(v,null,z(e.value.tags,(n,$)=>(t(),k(N,{size:"small",class:"me-2",key:$},{default:r(()=>[E(y(n),1)]),_:2},1024))),128))]),_:1}),_(a,{label:"描述"},{default:r(()=>[E(y(e.value.description),1)]),_:1}),_(a,{label:"版本"},{default:r(()=>[(t(!0),p(v,null,z(e.value.version,(n,$)=>(t(),k(N,{size:"small",key:$,class:"me-2"},{default:r(()=>[E(y(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),_(V,{ref_key:"formRef",ref:c,model:b,"label-width":"auto"},{default:r(()=>[_(w,{label:"选择安装的版本"},{default:r(()=>[_(C,{modelValue:b.version,"onUpdate:modelValue":l[0]||(l[0]=n=>b.version=n)},{default:r(()=>[(t(!0),p(v,null,z(e.value.version,(n,$)=>(t(),k(i,{border:"",value:n,label:n,disabled:e.value.already_installed_version.indexOf(n)!==-1,key:$},{default:r(()=>[E(y(n),1)]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),_(w,null,{default:r(()=>[e.value.actions&&e.value.allow_installation==="yes"?(t(!0),p(v,{key:0},z(e.value.actions,(n,$)=>(t(),k(D,{type:"success",onClick:F(U=>u($),["prevent"])},{default:r(()=>[E(y(n),1)]),_:2},1032,["onClick"]))),256)):(t(),p(v,{key:1},[e.value.allow_installation==="yes"?(t(),k(D,{key:0,type:"success",onClick:l[1]||(l[1]=F(n=>u("install"),["prevent"]))},{default:r(()=>[E("安装")]),_:1})):T("",!0)],64))]),_:1})]),_:1},8,["model"])]),_:1},8,["size"])}}},Te=he(We,[["__scopeId","data-v-90db7c0e"]]),Me={style:{padding:"14px"}},Oe=["textContent"],Ue=["textContent"],je={class:"bottom mt-2"},Ke={class:"time font-size-3 ms-2 me-2"},Ct={__name:"AppListView",setup(I){const d=R(),o=R(),b=R(),c=R(!1);Q(()=>{e()});const e=()=>{Y({url:"/v1/app/appstore"}).then(u=>{d.value=u.data})};function S(u,s){o.value=d.value[u],o.value.action=s,b.value.setAppInfo(o.value),c.value=!0}return(u,s)=>{const m=Z,l=X,a=fe,N=de,g=me;return t(),p(v,null,[_(g,{gutter:20},{default:r(()=>[(t(!0),p(v,null,z(f(d),(i,C)=>(t(),k(N,{xs:24,sm:24,md:8,lg:8,xl:6,class:"mb-2",key:C},{default:r(()=>[_(a,{"body-style":{padding:"0px"},shadow:"hover"},{default:r(()=>[h("div",Me,[h("div",null,[h("h3",{textContent:y(i.title),class:"font-size-4"},null,8,Oe),h("p",{textContent:y(i.description),class:"font-size-3"},null,8,Ue)]),h("div",je,[_(m,{class:"tag",type:"info",effect:"dark",size:"small",textContent:y(i.category)},null,8,["textContent"]),h("time",Ke,"latest:"+y(i.version[0]),1),i.actions&&i.allow_installation==="yes"?(t(!0),p(v,{key:0},z(i.actions,(w,D)=>(t(),k(l,{type:"success",onClick:F(V=>S(C,D),["prevent"])},{default:r(()=>[E(y(w),1)]),_:2},1032,["onClick"]))),256)):(t(),p(v,{key:1},[i.allow_installation==="yes"?(t(),k(l,{key:0,type:"success",onClick:F(w=>S(C,"install"),["prevent"])},{default:r(()=>[E("安装")]),_:2},1032,["onClick"])):T("",!0)],64))])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),_(Te,{ref_key:"installConfirmRef",ref:b,modelValue:f(c),"onUpdate:modelValue":s[0]||(s[0]=i=>pe(c)?c.value=i:null)},null,8,["modelValue"])],64)}}};export{Ct as default};
