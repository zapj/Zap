import{r as u,y as B,ao as m,o as g,j as D,B as e,m as t,a6 as i,k as r,A as _,a5 as R,l as A,aG as z,b8 as M,V as N,ad as S,ai as I,al as f}from"./index-a62a7a28.js";import{E as P}from"./el-card-85a77e75.js";import{E as j,a as q}from"./el-table-column-8104c127.js";/* empty css               */import{b as y}from"./commons-d455d4a5.js";import{E as F}from"./index-1a3cb46c.js";import{E as G}from"./index-06fc50a2.js";import{E as O,a as U}from"./index-35c6f9af.js";import{E as H}from"./index-818b1577.js";import"./index-c3ba0162.js";import"./event-2c073216.js";import"./isNil-c75b1b34.js";import"./use-form-item-453acac3.js";import"./use-form-common-props-9c2de981.js";import"./_initCloneObject-7450ca73.js";import"./index-07ca6cb1.js";const J={class:"dialog-footer"},de={__name:"TaskListView",setup(K){const d=u([]),p=u(!1),k=u(""),w=S(()=>I(()=>import("./LogViewer-4da6768d.js"),["assets/LogViewer-4da6768d.js","assets/xterm-db03418d.js","assets/xterm-ff373be6.css","assets/index-a62a7a28.js","assets/index-8e7b09c6.css"]));B(()=>{c()});const c=()=>{m({url:"/v1/task/appinstall/tasklist"}).then(s=>{d.value=s.data})},b=(s,a)=>{m({url:"/v1/task/appinstall/removetask",data:{id:a},dataType:"form",method:"post"}).then(l=>{d.value.splice(s,1),f({message:"删除成功",type:"success"})})},E=(s,a)=>{m({url:"/v1/task/appinstall/canceltask",data:{id:a},dataType:"form",method:"post"}).then(l=>{c(),f({message:"取消成功",type:"success"})})},h=(s,a)=>{k.value="install_"+a+".log",p.value=!0},C=()=>{m({url:"/v1/task/appinstall/gentask",dataType:"form",method:"post"}).then(s=>{f({message:"生成成功",type:"success"})})};return(s,a)=>{const l=j,n=G,V=q,T=P,x=O,L=U,$=H;return g(),D(N,null,[e(L,{gutter:20},{default:t(()=>[e(x,{span:24,class:"mb-2"},{default:t(()=>[e(T,{"body-style":{padding:"0px"},shadow:"hover"},{footer:t(()=>[e(n,{type:"primary",onClick:C},{default:t(()=>[i("安装")]),_:1}),e(n,{type:"primary",onClick:c},{default:t(()=>[i("刷新")]),_:1})]),default:t(()=>[e(V,{data:r(d),stripe:"",style:{width:"100%"}},{default:t(()=>[e(l,{prop:"id",label:"ID",width:"180"}),e(l,{prop:"title",label:"任务名称"}),e(l,{prop:"start_time",label:"开始时间",width:"180",formatter:r(y)},null,8,["formatter"]),e(l,{prop:"end_time",label:"完成时间",width:"180",formatter:r(y)},null,8,["formatter"]),e(l,{prop:"Status",label:"状态",width:"120"}),e(l,{prop:"error",label:"Error"}),e(l,{label:"操作",width:"120"},{default:t(o=>[e(n,{link:"",type:"primary",size:"small",onClick:_(v=>b(o.$index,o.row.id),["prevent"])},{default:t(()=>[i(" 删除 ")]),_:2},1032,["onClick"]),e(n,{link:"",type:"primary",size:"small",onClick:_(v=>E(o.$index,o.row.id),["prevent"])},{default:t(()=>[i(" 取消 ")]),_:2},1032,["onClick"]),e(n,{link:"",type:"primary",size:"small",onClick:_(v=>h(o.$index,o.row.id),["prevent"])},{default:t(()=>[i(" View Log ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),e($,{modelValue:r(p),"onUpdate:modelValue":a[1]||(a[1]=o=>M(p)?p.value=o:null),width:"80%",title:"LogViewer"},{footer:t(()=>[R("div",J,[e(n,{onClick:a[0]||(a[0]=o=>p.value=!1)},{default:t(()=>[i("关闭")]),_:1})])]),default:t(()=>[(g(),A(z,null,{default:t(()=>[e(r(w),{logfile:r(k)},null,8,["logfile"])]),fallback:t(()=>[e(r(F),{rows:4})]),_:1}))]),_:1},8,["modelValue"])],64)}}};export{de as default};
