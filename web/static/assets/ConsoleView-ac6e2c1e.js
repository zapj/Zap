import{x as i,a as d,b as r,c as a}from"./xterm-db03418d.js";import{o as l,a as u,f as m,L as f,K as w}from"./index-14135f82.js";const p=w("div",{id:"terminal"},null,-1),h={__name:"ConsoleView",setup(x){return l(()=>{const e=new i.Terminal({screenKeys:!0,useStyle:!0,cursorBlink:!0});e.open(document.getElementById("terminal"));let t="ws";location.protocol==="https:"&&(t="wss");const n=new WebSocket(t+"://"+location.host+"/api/v1/local/ws",[sessionStorage.getItem("access_token")]),c=new d.AttachAddon(n),s=new r.FitAddon;e.loadAddon(s),e.loadAddon(new a.WebLinksAddon),n.onclose=function(o){e.write(`连接已关闭，请刷新重试
`)},n.onopen=function(){e.loadAddon(c),e._initialized=!0,e.focus(),setTimeout(function(){s.fit()}),e.onResize(function(o){n.send(new TextEncoder().encode(""+JSON.stringify({cols:o.cols,rows:o.rows})))}),e.onTitleChange(function(o){console.log(o)}),e.onData(function(o){n.send(new TextEncoder().encode("\0"+o))}),window.onresize=function(){s.fit()}}}),(e,t)=>(u(),m("div",null,[f(" Terminal "),p]))}};export{h as default};
