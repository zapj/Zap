import{d as A,O as G,u as J,L as W,aa as P,e as _,a as t,f as p,m as h,F as v,M as D,b as k,j as f,_ as H,am as oe,U as ne,c as ae,g as x,i as j,p as E,t as y,k as T,l as ie,a9 as re,J as ce,r as R,o as Q,K as ue,w as r,h as F,ah as pe}from"./index-e26e72e9.js";import{E as de,a as me}from"./el-col-fa218f38.js";import{E as _e}from"./el-card-e1aad0b1.js";import{E as X}from"./el-button-91f41336.js";/* empty css               */import{a as Y}from"./client-00b0bb33.js";import{E as fe}from"./el-drawer-6550ab44.js";import"./el-overlay-797d8413.js";import{E as ve,a as ye}from"./el-form-item-3f424c56.js";import{b as be,a as ge}from"./el-radio-button-13504126.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{E as K}from"./index-b3b7ff7e.js";import{g as we,f as ke}from"./vnode-4474326f.js";import{b as q}from"./index-3bac334e.js";import{i as Ce}from"./isNil-c75b1b34.js";import{b as U,d as Ee}from"./runtime-909e2ee3.js";import{a as Se,u as ze}from"./use-form-common-props-0f5bc46c.js";import{E as Z}from"./index-15ea5ace.js";import"./typescript-d2ff6dd6.js";import"./constants-b6c0c234.js";import"./index-6838fe58.js";import"./use-global-config-e0c846e4.js";import"./use-form-item-59e5f47e.js";import"./index-9f57bd93.js";import"./index-0e6c4a62.js";import"./index-6fc089e4.js";import"./error-78e43d3e.js";import"./focus-trap-f40e746e.js";import"./event-8e91c63d.js";import"./castArray-cf011fb0.js";import"./_initCloneObject-9228ffc4.js";const M=Symbol("elDescriptions");var B=A({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:G(M,{})}},render(){var I,d,o,b,c,e,S;const u=we(this.cell),s=(((I=this.cell)==null?void 0:I.dirs)||[]).map($=>{const{dir:O,arg:te,modifiers:le,value:se}=$;return[O,se,te,le]}),{border:m,direction:l}=this.descriptions,a=l==="vertical",z=((b=(o=(d=this.cell)==null?void 0:d.children)==null?void 0:o.label)==null?void 0:b.call(o))||u.label,g=(S=(e=(c=this.cell)==null?void 0:c.children)==null?void 0:e.default)==null?void 0:S.call(e),i=u.span,C=u.align?`is-${u.align}`:"",w=u.labelAlign?`is-${u.labelAlign}`:C,N=u.className,V=u.labelClassName,L={width:q(u.width),minWidth:q(u.minWidth)},n=J("descriptions");switch(this.type){case"label":return W(P(this.tag,{style:L,class:[n.e("cell"),n.e("label"),n.is("bordered-label",m),n.is("vertical-label",a),w,V],colSpan:a?i:1},z),s);case"content":return W(P(this.tag,{style:L,class:[n.e("cell"),n.e("content"),n.is("bordered-content",m),n.is("vertical-content",a),C,N],colSpan:a?i:i*2-1},g),s);default:return W(P("td",{style:L,class:[n.e("cell"),C],colSpan:i},[Ce(z)?void 0:P("span",{class:[n.e("label"),V]},z),P("span",{class:[n.e("content"),N]},g)]),s)}}});const De=U({row:{type:Ee(Array),default:()=>[]}}),Ne={key:1},$e=A({name:"ElDescriptionsRow"}),Ie=A({...$e,props:De,setup(I){const d=G(M,{});return(o,b)=>_(d).direction==="vertical"?(t(),p(v,{key:0},[h("tr",null,[(t(!0),p(v,null,D(o.row,(c,e)=>(t(),k(_(B),{key:`tr1-${e}`,cell:c,tag:"th",type:"label"},null,8,["cell"]))),128))]),h("tr",null,[(t(!0),p(v,null,D(o.row,(c,e)=>(t(),k(_(B),{key:`tr2-${e}`,cell:c,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(t(),p("tr",Ne,[(t(!0),p(v,null,D(o.row,(c,e)=>(t(),p(v,{key:`tr3-${e}`},[_(d).border?(t(),p(v,{key:0},[f(_(B),{cell:c,tag:"td",type:"label"},null,8,["cell"]),f(_(B),{cell:c,tag:"td",type:"content"},null,8,["cell"])],64)):(t(),k(_(B),{key:1,cell:c,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var xe=H(Ie,[["__file","descriptions-row.vue"]]);const Re=U({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Se,title:{type:String,default:""},extra:{type:String,default:""}}),Ae=A({name:"ElDescriptions"}),Ve=A({...Ae,props:Re,setup(I){const d=I,o=J("descriptions"),b=ze(),c=oe();ne(M,d);const e=ae(()=>[o.b(),o.m(b.value)]),S=(s,m,l,a=!1)=>(s.props||(s.props={}),m>l&&(s.props.span=l),a&&(s.props.span=m),s),u=()=>{if(!c.default)return[];const s=ke(c.default()).filter(g=>{var i;return((i=g==null?void 0:g.type)==null?void 0:i.name)==="ElDescriptionsItem"}),m=[];let l=[],a=d.column,z=0;return s.forEach((g,i)=>{var C;const w=((C=g.props)==null?void 0:C.span)||1;if(i<s.length-1&&(z+=w>a?a:w),i===s.length-1){const N=d.column-z%d.column;l.push(S(g,N,a,!0)),m.push(l);return}w<a?(a-=w,l.push(g)):(l.push(S(g,w,a)),m.push(l),a=d.column,l=[])}),m};return(s,m)=>(t(),p("div",{class:x(_(e))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(t(),p("div",{key:0,class:x(_(o).e("header"))},[h("div",{class:x(_(o).e("title"))},[j(s.$slots,"title",{},()=>[E(y(s.title),1)])],2),h("div",{class:x(_(o).e("extra"))},[j(s.$slots,"extra",{},()=>[E(y(s.extra),1)])],2)],2)):T("v-if",!0),h("div",{class:x(_(o).e("body"))},[h("table",{class:x([_(o).e("table"),_(o).is("bordered",s.border)])},[h("tbody",null,[(t(!0),p(v,null,D(u(),(l,a)=>(t(),k(xe,{key:a,row:l},null,8,["row"]))),128))])],2)],2)],2))}});var Le=H(Ve,[["__file","description.vue"]]);const Pe=U({label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),ee=A({name:"ElDescriptionsItem",props:Pe}),Be=ie(Le,{DescriptionsItem:ee}),Fe=re(ee);const We={__name:"InstallConfirm",setup(I,{expose:d}){let o="50%";const b=ce({version:"",id:0}),c=R(),e=R({});Q(()=>{window.addEventListener("resize",S)}),ue(()=>{window.removeEventListener("resize",S)});const S=()=>{document.body.clientWidth<1200&&document.body.clientWidth>768?o="60%":document.body.clientWidth<768?o="100%":o="50%"};function u(m){Y({url:"/v1/app/appstore/install",method:"post",data:{id:e.value.app_id,action:m,version:b.version},dataType:"form"}).then(l=>{console.log(l),l.code==0?K({type:"success",message:l.msg}):K({type:"error",message:l.msg})})}return d({setAppInfo:function(m){e.value=m,b.id=e.value.id;for(let l=0;l<e.value.version.length;l++)if(e.value.already_installed_version.indexOf(e.value.version[l])!==-1){e.value.version[l];break}}}),(m,l)=>{const a=Fe,z=Z,g=Be,i=be,C=ge,w=ve,N=X,V=ye,L=fe;return t(),k(L,{title:"安装确认",size:_(o),"append-to-body":!0,direction:"rtl"},{header:r(()=>[h("span",null,"安装"+y(e.value.title),1)]),default:r(()=>[f(g,{title:"应用信息",column:1},{default:r(()=>[f(a,{label:"应用名称"},{default:r(()=>[E(y(e.value.title),1)]),_:1}),f(a,{label:"应用Name"},{default:r(()=>[E(y(e.value.name),1)]),_:1}),f(a,{label:"Tag"},{default:r(()=>[(t(!0),p(v,null,D(e.value.tags,(n,$)=>(t(),k(z,{size:"small",class:"me-2",key:$},{default:r(()=>[E(y(n),1)]),_:2},1024))),128))]),_:1}),f(a,{label:"描述"},{default:r(()=>[E(y(e.value.description),1)]),_:1}),f(a,{label:"版本"},{default:r(()=>[(t(!0),p(v,null,D(e.value.version,(n,$)=>(t(),k(z,{size:"small",key:$,class:"me-2"},{default:r(()=>[E(y(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),f(V,{ref_key:"formRef",ref:c,model:b,"label-width":"auto"},{default:r(()=>[f(w,{label:"选择安装的版本"},{default:r(()=>[f(C,{modelValue:b.version,"onUpdate:modelValue":l[0]||(l[0]=n=>b.version=n)},{default:r(()=>[(t(!0),p(v,null,D(e.value.version,(n,$)=>(t(),k(i,{border:"",value:n,label:n,disabled:e.value.already_installed_version.indexOf(n)!==-1,key:$},{default:r(()=>[E(y(n),1)]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),f(w,null,{default:r(()=>[e.value.actions&&e.value.allow_installation==="yes"?(t(!0),p(v,{key:0},D(e.value.actions,(n,$)=>(t(),k(N,{type:"success",onClick:F(O=>u($),["prevent"])},{default:r(()=>[E(y(n),1)]),_:2},1032,["onClick"]))),256)):(t(),p(v,{key:1},[e.value.allow_installation==="yes"?(t(),k(N,{key:0,type:"success",onClick:l[1]||(l[1]=F(n=>u("install"),["prevent"]))},{default:r(()=>[E("安装")]),_:1})):T("",!0)],64))]),_:1})]),_:1},8,["model"])]),_:1},8,["size"])}}},Te=he(We,[["__scopeId","data-v-e1430d11"]]),Ue={style:{padding:"14px"}},Me=["textContent"],Oe=["textContent"],je={class:"bottom mt-2"},Ke={class:"time font-size-3 ms-2 me-2"},Ct={__name:"AppListView",setup(I){const d=R(),o=R(),b=R(),c=R(!1);Q(()=>{e()});const e=()=>{Y({url:"/v1/app/appstore"}).then(u=>{d.value=u.data})};function S(u,s){o.value=d.value[u],o.value.action=s,b.value.setAppInfo(o.value),c.value=!0}return(u,s)=>{const m=Z,l=X,a=_e,z=de,g=me;return t(),p(v,null,[f(g,{gutter:20},{default:r(()=>[(t(!0),p(v,null,D(_(d),(i,C)=>(t(),k(z,{xs:24,sm:24,md:8,lg:8,xl:6,class:"mb-2",key:C},{default:r(()=>[f(a,{"body-style":{padding:"0px"},shadow:"hover"},{default:r(()=>[h("div",Ue,[h("div",null,[h("h3",{textContent:y(i.title),class:"font-size-4"},null,8,Me),h("p",{textContent:y(i.description),class:"font-size-3"},null,8,Oe)]),h("div",je,[f(m,{class:"tag",type:"info",effect:"dark",size:"small",textContent:y(i.category)},null,8,["textContent"]),h("time",Ke,"latest:"+y(i.version[0]),1),i.actions&&i.allow_installation==="yes"?(t(!0),p(v,{key:0},D(i.actions,(w,N)=>(t(),k(l,{type:"success",onClick:F(V=>S(C,N),["prevent"])},{default:r(()=>[E(y(w),1)]),_:2},1032,["onClick"]))),256)):(t(),p(v,{key:1},[i.allow_installation==="yes"?(t(),k(l,{key:0,type:"success",onClick:F(w=>S(C,"install"),["prevent"])},{default:r(()=>[E("安装")]),_:2},1032,["onClick"])):T("",!0)],64))])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),f(Te,{ref_key:"installConfirmRef",ref:b,modelValue:_(c),"onUpdate:modelValue":s[0]||(s[0]=i=>pe(c)?c.value=i:null)},null,8,["modelValue"])],64)}}};export{Ct as default};
