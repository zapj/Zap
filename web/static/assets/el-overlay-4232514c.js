import{b as P,d as C,c as G}from"./runtime-e5f589df.js";import{ai as K,u as A,aB as R,Z as E,aC as J,aq as S,d as Q,j as X,i as O,ab as ee,r as p,c as I,a2 as oe,o as te,$ as le,aD as ne}from"./index-4558e22a.js";import{P as B}from"./vnode-dafc8873.js";import{j as b,x as D,P as se,v as ae,w as ue,i as ie,M as ce,t as re,y as N}from"./index-60a14872.js";import{U as L}from"./event-8e91c63d.js";import{u as F}from"./index-ae1427e5.js";import{w as de}from"./use-global-config-0868fc11.js";import{t as fe}from"./error-78e43d3e.js";import{i as me}from"./focus-trap-8187f18e.js";let h;const ye=e=>{var t;if(!b)return 0;if(h!==void 0)return h;const o=document.createElement("div");o.className=`${e}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const s=o.offsetWidth;o.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",o.appendChild(l);const a=l.offsetWidth;return(t=o.parentNode)==null||t.removeChild(o),h=s-a,h};function Ie(e,t){if(!b)return;if(!t){e.scrollTop=0;return}const o=[];let s=t.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)o.push(s),s=s.offsetParent;const l=t.offsetTop+o.reduce((r,i)=>r+i.offsetTop,0),a=l+t.offsetHeight,n=e.scrollTop,c=n+e.clientHeight;l<n?e.scrollTop=l:a>c&&(e.scrollTop=a-e.clientHeight)}const ve=(e,t={})=>{K(e)||fe("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||A("popup"),s=R(()=>o.bm("parent","hidden"));if(!b||D(document.body,s.value))return;let l=0,a=!1,n="0";const c=()=>{setTimeout(()=>{ue(document==null?void 0:document.body,s.value),a&&document&&(document.body.style.width=n)},200)};E(e,r=>{if(!r){c();return}a=!D(document.body,s.value),a&&(n=document.body.style.width),l=ye(o.namespace.value);const i=document.documentElement.clientHeight<document.body.scrollHeight,f=se(document.body,"overflowY");l>0&&(i||f==="scroll")&&a&&(document.body.style.width=`calc(100% - ${l}px)`),ae(document.body,s.value)}),J(()=>c())},pe=e=>{if(!e)return{onClick:S,onMousedown:S,onMouseup:S};let t=!1,o=!1;return{onClick:n=>{t&&o&&e(n),t=o=!1},onMousedown:n=>{t=n.target===n.currentTarget},onMouseup:n=>{o=n.target===n.currentTarget}}},he=P({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:C([String,Array,Object])},zIndex:{type:C([String,Number])}}),Ce={click:e=>e instanceof MouseEvent},be="overlay";var ge=Q({name:"ElOverlay",props:he,emits:Ce,setup(e,{slots:t,emit:o}){const s=A(be),l=r=>{o("click",r)},{onClick:a,onMousedown:n,onMouseup:c}=pe(e.customMaskEvent?void 0:l);return()=>e.mask?X("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:a,onMousedown:n,onMouseup:c},[O(t,"default")],B.STYLE|B.CLASS|B.PROPS,["onClick","onMouseup","onMousedown"]):ee("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[O(t,"default")])}});const De=ge,we=P({center:Boolean,alignCenter:Boolean,closeIcon:{type:ie},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Ne={close:()=>!0},Fe=P({...we,appendToBody:Boolean,appendTo:{type:C(String),default:"body"},beforeClose:{type:C(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),Ae={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[L]:e=>G(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Le=(e,t)=>{var o;const l=le().emit,{nextZIndex:a}=ce();let n="";const c=F(),r=F(),i=p(!1),f=p(!1),v=p(!1),g=p((o=e.zIndex)!=null?o:a());let m,y;const z=de("namespace",ne),H=I(()=>{const u={},d=`--${z.value}-dialog`;return e.fullscreen||(e.top&&(u[`${d}-margin-top`]=e.top),e.width&&(u[`${d}-width`]=re(e.width))),u}),W=I(()=>e.alignCenter?{display:"flex"}:{});function _(){l("opened")}function $(){l("closed"),l(L,!1),e.destroyOnClose&&(v.value=!1)}function V(){l("close")}function k(){y==null||y(),m==null||m(),e.openDelay&&e.openDelay>0?{stop:m}=N(()=>M(),e.openDelay):M()}function w(){m==null||m(),y==null||y(),e.closeDelay&&e.closeDelay>0?{stop:y}=N(()=>T(),e.closeDelay):T()}function x(){function u(d){d||(f.value=!0,i.value=!1)}e.beforeClose?e.beforeClose(u):w()}function U(){e.closeOnClickModal&&x()}function M(){b&&(i.value=!0)}function T(){i.value=!1}function Y(){l("openAutoFocus")}function j(){l("closeAutoFocus")}function Z(u){var d;((d=u.detail)==null?void 0:d.focusReason)==="pointer"&&u.preventDefault()}e.lockScroll&&ve(i);function q(){e.closeOnPressEscape&&x()}return E(()=>e.modelValue,u=>{u?(f.value=!1,k(),v.value=!0,g.value=me(e.zIndex)?a():g.value++,oe(()=>{l("open"),t.value&&(t.value.scrollTop=0)})):i.value&&w()}),E(()=>e.fullscreen,u=>{t.value&&(u?(n=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=n)}),te(()=>{e.modelValue&&(i.value=!0,v.value=!0,k())}),{afterEnter:_,afterLeave:$,beforeLeave:V,handleClose:x,onModalClick:U,close:w,doClose:T,onOpenAutoFocus:Y,onCloseAutoFocus:j,onCloseRequested:q,onFocusoutPrevented:Z,titleId:c,bodyId:r,closed:f,style:H,overlayDialogStyle:W,rendered:v,visible:i,zIndex:g}};export{De as E,pe as a,Ae as b,Le as c,Fe as d,we as e,Ne as f,Ie as s,ve as u};
